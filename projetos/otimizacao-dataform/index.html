<!DOCTYPE html><html lang="pt-br" class="scroll-smooth"> <head><meta charset="UTF-8"><meta name="description" content="Portfólio de um Engenheiro de Dados"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.16.19"><title>Otimização de Pipelines com Dataform</title><link rel="stylesheet" href="/_astro/index.DPX2mvyT.css"></head> <body class="bg-slate-900 text-slate-300 leading-relaxed">  <main class="pt-24 pb-20"> <article class="max-w-4xl mx-auto px-4"> <header class="text-center mb-12"> <h1 class="text-4xl md:text-5xl font-bold text-white mb-4">Otimização de Pipelines com Dataform</h1> <p class="text-lg md:text-xl text-slate-300">Redução de 98.5% em custos de processamento no BigQuery e melhora de performance em módulos SaaS.</p> </header> <div class="prose prose-invert prose-lg max-w-none mx-auto"> <blockquote class="border-l-4 border-emerald-500 bg-slate-800/50 p-4 rounded-r-lg"> <p>Este estudo de caso detalha a migração de pipelines de dados legados e de alto custo para uma arquitetura moderna e eficiente utilizando Google Dataform, resultando em uma economia drástica e maior confiabilidade dos dados.</p> </blockquote> <section class="mt-12"> <h2 class="text-3xl font-bold text-white mb-4">O Desafio</h2> <p>Pipelines legados em uma plataforma SaaS estavam gerando custos elevados de processamento no BigQuery, tornando a operação insustentável a longo prazo.</p><p>A manutenção era complexa e a performance impactava a entrega de dados para módulos críticos do produto.</p><p>Era necessário criar uma solução robusta, escalável e, acima de tudo, custo-efetiva para suportar o crescimento da empresa.</p> </section> <section class="mt-12"> <h2 class="text-3xl font-bold text-white mb-4">Minha Contribuição</h2> <ul class="list-none p-0"> <li class="flex items-start mb-2"> <svg width="1em" height="1em" class="text-emerald-400 w-6 h-6 mr-3 flex-shrink-0 mt-1" data-icon="mdi:check-decagram">   <symbol id="ai:mdi:check-decagram" viewBox="0 0 24 24"><path fill="currentColor" d="m23 12l-2.44-2.78l.34-3.68l-3.61-.82l-1.89-3.18L12 3L8.6 1.54L6.71 4.72l-3.61.81l.34 3.68L1 12l2.44 2.78l-.34 3.69l3.61.82l1.89 3.18L12 21l3.4 1.46l1.89-3.18l3.61-.82l-.34-3.68zm-13 5l-4-4l1.41-1.41L10 14.17l6.59-6.59L18 9z"/></symbol><use href="#ai:mdi:check-decagram"></use>  </svg> <span>Arquitetei a solução de ponta a ponta na Google Cloud Platform.</span> </li><li class="flex items-start mb-2"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-emerald-400 w-6 h-6 mr-3 flex-shrink-0 mt-1" data-icon="mdi:check-decagram">   <use href="#ai:mdi:check-decagram"></use>  </svg> <span>Desenvolvi os modelos de dados no Dataform seguindo a arquitetura Medallion (Bronze, Silver, Gold).</span> </li><li class="flex items-start mb-2"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-emerald-400 w-6 h-6 mr-3 flex-shrink-0 mt-1" data-icon="mdi:check-decagram">   <use href="#ai:mdi:check-decagram"></use>  </svg> <span>Liderei o processo de migração, garantindo a qualidade e a consistência dos dados.</span> </li><li class="flex items-start mb-2"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-emerald-400 w-6 h-6 mr-3 flex-shrink-0 mt-1" data-icon="mdi:check-decagram">   <use href="#ai:mdi:check-decagram"></use>  </svg> <span>Colaborei com stakeholders para validar os novos modelos e dashboards.</span> </li> </ul> </section> <section class="mt-12"> <h2 class="text-3xl font-bold text-white mb-4">Arquitetura da Solução</h2> <figure> <img src="/diagrama-dataform.png" alt="Diagrama de arquitetura do projeto Otimização de Pipelines com Dataform" class="rounded-lg shadow-lg"> <figcaption class="text-center text-sm text-slate-400 mt-2">Diagrama de alto nível do fluxo de dados implementado.</figcaption> </figure> </section> <section class="mt-12"> <h2 class="text-3xl font-bold text-white mb-4">Deep Dive Técnico</h2> <div class="mb-8"> <h3 class="text-2xl font-semibold text-emerald-400 mb-2">Modelagem com Google Dataform</h3> <p>Abaixo, um exemplo anonimizado de um modelo da camada &quot;Silver&quot;, onde dados brutos são limpos, tipados e preparados para agregação. Usamos arquivos SQLX para combinar a declaração da tabela com a lógica de transformação.</p> <div class="bg-slate-900 rounded-lg overflow-hidden my-4"> <pre class="p-4 text-sm"><code class="language-sql">config { type: &quot;table&quot; }

SELECT
    CAST(user_id AS STRING) AS id_usuario,
    CAST(event_timestamp AS TIMESTAMP) AS data_evento,
    JSON_VALUE(event_data, &#39;$.plan_type&#39;) AS tipo_plano,
    SAFE_CAST(JSON_VALUE(event_data, &#39;$.mrr_value&#39;) AS NUMERIC) AS valor_mrr
FROM
    source.bronze_events
WHERE
    event_name = &#39;user_subscribed&#39;</code></pre> </div>  </div><div class="mb-8"> <h3 class="text-2xl font-semibold text-emerald-400 mb-2">Dashboard de Análise de Custo</h3> <p>Para validar o sucesso do projeto, criei um dashboard no Looker Studio que compara os custos de processamento antes e depois da migração. Abaixo está uma versão pública e anonimizada do dashboard, usando dados de exemplo.</p>  <div class="aspect-w-16 aspect-h-9 my-4"> <iframe src="https://lookerstudio.google.com/embed/reporting/0B5FF6n02-312Y1llWmN2U2Q4S3M/page/6zXD" frameborder="0" style="border:0; width: 100%; height: 500px;" allowfullscreen></iframe> </div> </div> </section> <section class="mt-12"> <h2 class="text-3xl font-bold text-white mb-4">Resultados e Impacto</h2> <ul class="list-none p-0"> <li class="flex items-start mb-2"> <svg width="1em" height="1em" class="text-amber-400 w-6 h-6 mr-3 flex-shrink-0 mt-1" data-icon="mdi:trophy-variant">   <symbol id="ai:mdi:trophy-variant" viewBox="0 0 24 24"><path fill="currentColor" d="M17 4V2H7v2H2v7c0 1.1.9 2 2 2h3.1a5.01 5.01 0 0 0 3.9 3.9v2.18C8 19.54 8 22 8 22h8s0-2.46-3-2.92V16.9a5.01 5.01 0 0 0 3.9-3.9H20c1.1 0 2-.9 2-2V4zM4 11V6h3v5zm16 0h-3V6h3z"/></symbol><use href="#ai:mdi:trophy-variant"></use>  </svg> <span>Redução de 98.5% nos custos mensais de processamento no BigQuery, de R$ X mil para R$ Y.</span> </li><li class="flex items-start mb-2"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-amber-400 w-6 h-6 mr-3 flex-shrink-0 mt-1" data-icon="mdi:trophy-variant">   <use href="#ai:mdi:trophy-variant"></use>  </svg> <span>Melhora de 4x na performance de execução dos pipelines.</span> </li><li class="flex items-start mb-2"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-amber-400 w-6 h-6 mr-3 flex-shrink-0 mt-1" data-icon="mdi:trophy-variant">   <use href="#ai:mdi:trophy-variant"></use>  </svg> <span>Redução do tempo de entrega de dados para stakeholders de 8 horas para menos de 1 hora.</span> </li><li class="flex items-start mb-2"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-amber-400 w-6 h-6 mr-3 flex-shrink-0 mt-1" data-icon="mdi:trophy-variant">   <use href="#ai:mdi:trophy-variant"></use>  </svg> <span>Criação de uma base de dados escalável e de fácil manutenção para o futuro.</span> </li> </ul> </section> </div> <div class="text-center mt-16"> <a href="/#projetos" class="text-emerald-400 hover:text-emerald-300 font-semibold">
&larr; Voltar para todos os projetos
</a> </div> </article> </main>  </body></html>