---
// src/components/LanguageSwitcher.astro

const { pathname } = Astro.url;

// 1. Descobrimos o "caminho base", removendo qualquer prefixo de idioma.
const basePath = pathname.startsWith('/pt/') ? pathname.replace('/pt', '')
               : pathname.startsWith('/en/') ? pathname.replace('/en', '')
               : pathname;

// 2. Construímos os links completos e corretos para cada idioma.
// Adicionamos uma verificação para evitar a barra dupla "//" na página inicial.
const enPath = basePath === '/' ? '/en/' : `/en${basePath}`;
const ptPath = basePath === '/' ? '/pt/' : `/pt${basePath}`;

// 3. Identificamos o idioma atual de forma mais segura.
const currentLocale = Astro.currentLocale;
---

<div class="flex items-center gap-3 text-sm font-medium">
  <a 
    href={ptPath} 
    class:list={[
      "transition",
      currentLocale === 'pt' 
        ? 'text-emerald-400 font-bold' 
        : 'text-slate-300 hover:text-emerald-400'
    ]}
  >
    PT
  </a>
  
  <div class="w-px h-4 bg-slate-600"></div>
  
  <a 
    href={enPath} 
    class:list={[
      "transition",
      currentLocale === 'en' 
        ? 'text-emerald-400 font-bold' 
        : 'text-slate-300 hover:text-emerald-400'
    ]}
  >
    EN
  </a>
</div>